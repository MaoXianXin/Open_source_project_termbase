# 时序数据库管理系统 （Timeseries Database Management System）
时序数据库管理系统是专门用于存储、处理、维护和管理时间序列数据的数据库系统软件，支持时序数据读写、压缩存储、插值和聚合等功能，通常采用列式存储结构。现有的时序数据库管理系统包括 Apache IoTDB、InfluxDB、OpenTSDB 等。

# 时间序列（Timeseries）/ 时间线 （Timeline）
时间序列是指将某一个度量指标在不同时间上的各个数值，按时间先后顺序排列而形成的序列，可以是一段时间的序列，也可以是无界的序列。如在时序数据库 Aapche IoTDB 中，一个设备实体的一个物理量定位一个时间序列,即实体+物理量=时间序列。例如，ln 电力集团、wf01 风电场的实体 wt01 有名为 status 的物理量，则它的时间序列可以表示为：root.ln.wf01.wt01.status。

# 物理量 / 工况 / 测点
时间序列数据一般由一个传感器或一个虚拟采集器产生，在不同的应用中，这些电子设备往往有不同的名称，如物理量、工况、测点、变量等。在时序数据库 Apache IoTDB 中称为物理量，如风速、光照、电压。

# 设备（Device） / 实体（Entity）
指拥有传感器和监测指标的设备或装置，如一台风力发电机、一台物流车。在时序数据库 Apache IoTDB 中，实体与设备均指的是元数据树叶子节点（物理量节点）的父节点。例如，ln 电力集团、wf01 风电场的实体 wt01 有名为 status 的物理量，其中root.ln.wf01.wt01为设备（实体）。

# 对齐序列（Aligned Timeseries）
在设备数据采集场景中，有的设备下的多个物理量是同时采集的，例如 GPS 信息同时包括经度和纬度，在时序数据库 Apache IoTDB 中，这样的一组物理量对应的序列称为对齐序列，在存储时将共享时间戳。

# 非对齐序列（NonAligned Timeseries）
在设备数据采集场景中，有的设备下的多个物理量是独立采集的，各个序列的采集时间不同，需要独立存储，在时序数据库 Apache IoTDB 中，这样的一组物理量对应的序列称为非对齐序列，每条序列分别存储一列时间戳。

# 存储组（Storage Group）
存储组是时序数据库 Apache IoTDB 中的逻辑概念，从数据模型上来看，存储组是一组物理实体的集合吗，具有相关性的一组数据往往被组织在同一个存储组下。存储组不允许互相嵌套，且存储组是数据隔离的单位，不同存储组的数据在磁盘上会分离存储。

# 标签（tag）
标签是时间序列的描述信息和标识信息，被广泛应用于时序数据产品的数据模型中，通常用来对设备进行打标签，如实验室=一号、计算机=三号、硬件=CPU是三个标签，可以定位一个设备。在 Influxdb 中，用户可以基于标签实现灵活的序列集筛选与查询，Influxdb通过TSI技术实现高效的标签倒排索引。在IoTDB中，标签信息可以转化为具有一定层次关系的元数据树，树的每一层可以看作一个tag-key对应的所有tag-value。

# 路径（Path）
路径是时序数据库 Apache IoTDB 中对时间序列的定位方式，元数据树上一个节点的路径指的是从根节点到当前节点所经过的所有节点的名称的连接，节点间通过 '.' 分隔。一条时间序列由该序列在元数据树上对应节点的路径唯一标识，在 Apache IoTDB 中，路径以 root 开头，root 为所有路径的根节点，如 root.风场1.风机1.风速 为一条时间序列的路径。

# 自动注册
在时序数据库 Apache IoTDB 中，数据可以直接进行写入操作，由数据库自动完成时间序列的注册，而不需要手动进行注册，这一特性即自动注册，或设备定义元数据。在传统的关系型数据库中，用户需要预先创建表，为数据写入做准备。然而，在工业物联网场景下，新增时间序列的需求普遍存在，需要灵活的元数据注册机制。

# 类型推断
终端设备采集的数据可能以字符串格式传输到服务器，然而其实际数据类型可能是整形或浮点型，如“123”，“12.3”，此时可以根据此字符串的格式推断数据类型，这一特性就是类型推断。如时序数据库 Apache IoTDB 中具有自动注册时间序列的特性，在注册序列的过程中，确定时间序列的数据类型是最重要的环节之一。

# 设备模板
工业物联网场景下，往往存在大量同类型的设备，这些设备往往配有同样的传感器，其数据类型也相同。设备模板定义了一类设备包含的物理量集合，设备模板可供所有设备共享，达到精简信息量的效果。在时序数据库 Apache IoTDB 中，用户可以通过使用设备模板，减少大量同类设备场景下的元数据内存开销，提升数据库效率。

# 乱序数据
乱序数据指的是不按照某种顺序排列的数据集合，在时序数据库中特指不按照时间顺序排列的数据集合。在 Apache IoTDB 中，以一个设备已经落盘数据的时间戳区分乱序数据，小于等于此时间戳的为乱序数据，通过将顺序数据和乱序数据分开存储，能够减少乱序对查询的影响。

# 时间分区
时间分区用于标识某个时间范围内的所有数据。在时间序列管理场景，通常将数据按照时间维度进行分区管理，一段固定的时间段作为时间分区的粒度，如1天一个分区。时间分区是分布式时序数据库的基本功能，如 Apache IoTDB 根据时间维度进行数据分区。

# 时间精度
时间精度指的是时间戳的单位，是一种用来计量时间的方法，如秒、毫秒、微妙、纳秒。时序数据库对时间精度要求很高，时间精度越高，单位时间可以对应更多的数据点，从而可以支持更高的数据采样频率。通常时序数据库的时间的精度是固定的，如 InfluxDB 只支持纳秒精度，Apache IoTDB 支持毫秒、微秒、纳秒三种时间精度。

# 旋转门
旋转门压缩算法（Spinning Door Transformation, SDT）是一种有损压缩算法，使用线性拟合来表示大量数据，具有效率高、压缩比高、实现简单、误差可控等优点，被广泛应用于实时数据库中。在时序数据库中也有相关应用，如 Apache IoTDB 可以使用旋转门压缩算法压缩 INT32、INT64、FLOAT、DOUBLE 这四种数据类型，当数据刷到磁盘时进行旋转门压缩。

# 编码方式
编码是将原始数据转化为少量字节的过程，不同的编码方式适用的数据类型和数据规律不同。编码能够提升数据的压缩比，减少空间占用，此外，在写数据以及读数据的过程中都能够减少 I/O 操作的数据量从而提高性能。通常时序数据库会支持多种编码方式，以适应不同数据类型的存储需求，如时序数据库 Apache IoTDB 支持 PLAIN 编码、二阶差分编码、游程编码、GORILLA 编码、字典编码等。

# 压缩方式
数据压缩是指在不丢失有用信息的前提下，缩减数据量以减少存储空间，提高其传输、存储和处理效率，或按照一定的算法对数据进行重新组织，减少数据的冗余和存储的空间的一种技术方法。数据压缩包括有损压缩和无损压缩。通常时序数据库支持多种压缩方式，如时序数据库 Apache IoTDB 允许在创建一个时间序列的时候指定该列的压缩方式，包括 SNAPPY、LZ4、GZIP、旋转门压缩。

# TTL（Time-To-Live）
数据存活时间，通常时序数据管理场景中数据量庞大，无法存储全量历史数据，仅能存储近期数据，因此可设置 TTL，将过期数据自动删除。如设置 TTL 为 3 个月，则 3 个月之前的数据将被自动删除。时序数据库通常都支持 TTL，如 Apache IoTDB、InfluxDB、OpenTSDB。

# TLSM
LSM 是 NoSQL 系统的常见存储引擎，而时序数据库 Apache IoTDB 对 LSM 引擎进行了优化，为了应对时序数据中数据乱序的现象，IoTDB 将顺序、乱序数据分开处理，形成两个数据空间，数据合并机制也是基于两个数据空间的，可以在出现乱序数据时，有效减少写放大，提升查询性能。由于这套方案是针对时序数据设计的，因此命名为TLSM。

# 查询引擎
查询引擎是位于数据库存储引擎之上的一个组件，他能够接收用户传来的 SQL，生成查询计划，根据数据库中的统计信息进行查询优化，并对存储引擎中的数据执行查询，为用户或应用程序返回结果。

# 分段聚合
分段聚合是一种时序数据典型的查询方式，数据以高频进行采集，需要按照一定的时间间隔进行聚合计算，如计算每天的平均气温，需要将气温的序列按天进行分段，然后计算平均值。一般时序数据库分段聚合功能中的段是连续的，如 InfluxDB、OpenTSDB，也有时序数据库中的段可以是不连续的，如计算每天8点-18点的平均气温，Apache IoTDB 中表示为 group by ([2021-11-01 08:00:00, 2021-12-01 18:00:00), 10h, 24h) 表示以 10 小时进行分段，以 24 小时进行滑动。

# 降采样
降采样查询是指使用比数据采集的时间频率更低的频率进行的一种查询方式，是分段聚合的一种特例。例如，数据采集的频率是一秒，想按照1分钟对数据进行展示，则需要使用降采样查询。在时序数据库 Apache IoTDB 中，用户可以使用 Group by 子句来进行降采样查询。

# 触发器
触发器是指由事件驱动，在满足定义条件时触发，并执行触发器中定义的语句集合的功能。触发器提供了一种监听序列数据变动的机制，配合用户自定义逻辑，可完成告警、数据清洗、数据转发等功能。时序数据库 Apache IoTDB 中允许用户动态装载、卸载触发器，在装载、卸载期间，无需启停服务器。

# UDF
UDF（user-defined functions），是用户自定义函数的简称。用户可以通过使用 UDF 来创建符合自己查询场景的查询函数。UDF 用来为数据库扩充领域函数，如时序数据库 Apache IoTDB 中支持创建 UDF 并动态加载，并提供 UDF 函数库，其中实现了一系列关于数据质量的函数，包括数据画像、数据质量评估与修复等，有效满足了工业领域对数据质量的需求。

# 连续查询
连续查询(Continuous Queries) 是指自动对实时数据进行的周期性查询，可用于定时计算聚合结果。如果需要每隔固定时间对实时数据进行查询，则可以使用连续查询功能。在时序数据库 Apache IoTDB 中可以通过 SQL 语句注册、或卸载一个 CQ 实例，以及查询到所有已经注册的 CQ 配置信息。

# 最新点查询
最新点查询是时序数据库 Apache IoTDB 中提供的一种特殊查询，最新点查询返回时间序列中时间戳最大的数据点，即一条序列的最新状态。用户可以通过 select last 指定查询最新点。由于最新点数据表征了当前状态，因此在物联网数据分析场景中尤为重要。为了提供毫秒级的返回速度，Apache IoTDB 对最新点查询进行了缓存优化，满足用户对设备实时监控的性能需求。

# 查询缓存
查询缓存是指查询引擎中的数据缓存，当数据被访问过后，即存在内存里作为缓存，供下次查询直接使用。通过使用查询缓存，可以有效加速查询的执行过程，提升系统的查询响应能力。不同数据库缓存的内容不同，如时序数据库 Apache IoTDB 中把查询过程中从文件中读取的数据块 Chunk 及索引信息 ChunkMetadata 缓存在内存中，减少磁盘IO的频率，从而加速查询执行。

# 查询写回
查询写回是时序数据库 Apache IoTDB 提供的一种高级数据处理功能，指将查询结果重新写入到数据库中，常用于对数据进行备份或存档，也可以作为降采样结果存储。用户可以使用 SELECT INTO 语句将查询结果集写回到指定序列中。

# 查询补空值
当对序列进行分段聚合时，某一段时间可能不存在数据，则此段数据的聚合结果为空，但这种空值不利于进行数据可视化展示和分析，需要对空值进行填补。查询补空值允许用户按照特定的方法对查询结果填充空值，如取前一个不为空的值，或线性插值。补空值之后的查询结果能更好地反映数据分布，有利于用户进行数据分析。在时序数据库 Apache IoTDB 中，用户可以使用 FILL 子句指定某一时间窗口数据缺失的情况下的填充模式。

# 数据同步
出于数据备份或网络条件的考虑，有时需要将一个数据库中的数据同步到另一个数据库实例中。通常存在两种数据同步方式，在传统关系数据库中，使用操作级的同步方案，此种同步方式延迟较小，但需要将一个写入操作在接收端重做，会占用两倍计算资源。为应对物联网场景对数据同步的流量消耗限制，时序数据库 Apache IoTDB 额外提供了基于数据文件 TsFile 的同步方案，具有高吞吐、低流量的优点，接收端无需重复计算。

# TsFile
TsFile 是时序数据库 Apache IoTDB 中的面向时序数据优化的列式存储文件格式，能够大大减少数据存储所需要的硬件资源，优化数据查询性能。在数据存储方面，TsFile 提供多种数据编码和压缩的方法，够将数据按照时间序列进行高效的压缩，可为用户节约高达 90%的数据存储空间；在数据查询方面，得益于其面向时序数据的数据组织方式，能够提供极速的数据过滤与查询，并结合原生的聚合索引信息，提供高效的聚合查询。同时，TsFile是一种可自解析的文件格式，可以非常方便地与 Spark、Hive 等大数据平台集成。

# 端-边-云
与传统互联网应用将用户与用户通过网络连接起来不同，物联网应用的参与对象跨域了“端”、“边”、“云”，形成了更复杂的应用模式。端侧通常为设备本地，如一个发电机组、一辆物流车、一台风机等，其存储计算资源较少，需要在无网络时将生成的数据在本地进行缓存，或者持久化存储以支持边缘计算等应用。 边侧通常为边缘网关节点或本地控制节点，如工厂级物联网平台、集控系统，接收多台设备的数据，实时监控设备状态，并需要支持高效的增删改查功能。 云侧通常为公司级大数据平台，所有工厂的数据会汇总至云平台进行数据分析。